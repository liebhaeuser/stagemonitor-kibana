<div>

  <h3>
    Visualization for trace {{ctrl.trace._source.trace_id}} (<a target="_blank" href="../app/kibana#/discover/Request-Analysis?_g=(time:(from:now-1h,mode:quick,to:now))&_a=(filters:!((meta:(alias:!n,disabled:!f,index:'stagemonitor-spans-*',key:trace_id,negate:!f,value:'{{ctrl.trace._source.trace_id}}'),query:(match:(trace_id:(query:'{{ctrl.trace._source.trace_id}}',type:phrase))))),index:'stagemonitor-spans-*')">show all spans for this trace</a>)
    <small class="pull-right"><a onclick="event.preventDefault(); return false;" href="#/trace/{{ctrl.trace._source.trace_id}}">Permalink</a></small>
  </h3>

  <div class="trace-visualization">
    <svg id="trace-{{ctrl.trace._source.trace_id}}">
      <g></g>
    </svg>
  </div>

  <div ng-if="ctrl.selectedSpan != null">
    <h3>
      Details for span <code>{{ctrl.selectedSpan._source.name}}</code>
    </h3>

    <div class="doc-viewer">
      <table class="table table-condensed span-details">
        <tr ng-repeat="prop in ctrl.selectedSpanProperties">
          <td>{{prop.propName}}</td>
          <td>{{prop.value}}</td>
        </tr>
      </table>
    </div>
  </div>

</div>
